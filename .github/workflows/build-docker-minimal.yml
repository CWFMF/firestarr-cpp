name: build-docker

on:
  push:
    branches: [ "main", "dev", "unstable" ]
    tags: [ "*" ]
  workflow_dispatch:

env:
  REGISTRY_IMAGE: ghcr.io/cwfmf/firestarr-cpp/firestarr

jobs:
  # uses cache from firestarr image but get error when combined
  # FIX: Error: Failed to CreateArtifact: Received non-retryable error:
  #      Failed request: (409) Conflict: an artifact with this name already
  #      exists on the workflow run
  build-firestarr-minimal:
    uses: ./.github/workflows/build-docker-image.yml
    with:
      image: firestarr-minimal
